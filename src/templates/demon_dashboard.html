<!DOCTYPE html>
<html lang="en" class="oni-theme">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂÜ•Âøç MYS≈åNINJA | Demon War Room</title>
    <style>
        /* === ONI DEMON THEME === */
        :root {
            --blood-crimson: #ff0033;
            --demon-gold: #ffcc00;
            --shadow-void: #000000;
            --oni-purple: #8a2be2;
            --hellfire-orange: #ff4400;
            --neon-cyan: #00ffff;
            --steel-gray: #2a2a2a;
            --dark-metal: #1a1a1a;
            --toxic-green: #00ff88;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: 
                radial-gradient(circle at 20% 80%, var(--oni-purple) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, var(--blood-crimson) 0%, transparent 50%),
                linear-gradient(135deg, var(--shadow-void) 0%, var(--dark-metal) 100%);
            color: white;
            font-family: 'Rajdhani', 'Segoe UI', sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* === DEMON HEADER === */
        .demon-header {
            background: linear-gradient(135deg, 
                rgba(255, 0, 51, 0.9) 0%, 
                rgba(138, 43, 226, 0.9) 50%, 
                rgba(0, 0, 0, 0.9) 100%);
            padding: 25px;
            text-align: center;
            border-bottom: 4px solid var(--demon-gold);
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 50px var(--blood-crimson);
        }
        
        .demon-header::before {
            content: 'üó°Ô∏è';
            position: absolute;
            font-size: 4em;
            left: 50px;
            top: 50%;
            transform: translateY(-50%);
            opacity: 0.3;
            animation: float 3s ease-in-out infinite;
        }
        
        .demon-header::after {
            content: 'üòà';
            position: absolute;
            font-size: 4em;
            right: 50px;
            top: 50%;
            transform: translateY(-50%);
            opacity: 0.3;
            animation: float 3s ease-in-out infinite reverse;
        }
        
        .header-title {
            font-size: 3.5em;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 3px;
            margin-bottom: 10px;
            background: linear-gradient(45deg, var(--demon-gold), var(--neon-cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(255, 204, 0, 0.5);
        }
        
        .header-subtitle {
            font-size: 1.2em;
            color: var(--neon-cyan);
            margin-bottom: 15px;
            font-weight: 300;
            letter-spacing: 2px;
        }
        
        .creators-badge {
            background: linear-gradient(45deg, var(--shadow-void), var(--steel-gray));
            padding: 12px 25px;
            border-radius: 25px;
            border: 2px solid var(--demon-gold);
            display: inline-block;
            font-weight: bold;
            box-shadow: 0 0 20px var(--demon-gold);
            animation: pulse-glow 2s infinite;
        }
        
        /* === WAR ROOM GRID === */
        .war-room {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 0;
            height: 100vh;
        }
        
        /* === SIDEBAR - TARGET MANAGEMENT === */
        .targets-sidebar {
            background: rgba(10, 10, 10, 0.95);
            border-right: 3px solid var(--demon-gold);
            padding: 20px;
            overflow-y: auto;
        }
        
        .sidebar-section {
            margin-bottom: 25px;
            border: 1px solid var(--steel-gray);
            border-radius: 10px;
            padding: 15px;
            background: rgba(26, 26, 26, 0.8);
        }
        
        .section-title {
            color: var(--neon-cyan);
            font-weight: 700;
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 1px solid var(--steel-gray);
            padding-bottom: 8px;
        }
        
        .web-input {
            width: 100%;
            background: var(--shadow-void);
            border: 1px solid var(--steel-gray);
            border-radius: 5px;
            color: white;
            padding: 10px 12px;
            margin-bottom: 10px;
            font-family: 'Courier New', monospace;
            transition: all 0.3s ease;
        }
        
        .web-input:focus {
            border-color: var(--neon-cyan);
            box-shadow: 0 0 10px var(--neon-cyan);
            outline: none;
        }
        
        .web-btn {
            width: 100%;
            background: linear-gradient(45deg, var(--blood-crimson), var(--oni-purple));
            border: 1px solid var(--demon-gold);
            border-radius: 5px;
            color: white;
            padding: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-bottom: 8px;
        }
        
        .web-btn:hover {
            box-shadow: 0 0 15px var(--blood-crimson);
            transform: translateY(-2px);
        }
        
        .target-list {
            max-height: 150px;
            overflow-y: auto;
            background: var(--shadow-void);
            border-radius: 5px;
            padding: 10px;
            margin-top: 10px;
        }
        
        .target-item {
            padding: 8px;
            border-bottom: 1px solid var(--steel-gray);
            font-size: 0.9em;
            font-family: 'Courier New', monospace;
        }
        
        /* === MAIN ATTACK AREA === */
        .main-attack-area {
            padding: 25px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.3);
        }
        
        .attack-modules-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .attack-module {
            background: linear-gradient(145deg, 
                rgba(42, 42, 42, 0.95) 0%, 
                rgba(26, 26, 26, 0.98) 100%);
            border: 3px solid;
            border-radius: 15px;
            padding: 0;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            box-shadow: 
                0 10px 30px rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }
        
        .attack-module:hover {
            transform: translateY(-5px);
            box-shadow: 
                0 15px 40px rgba(255, 0, 51, 0.3),
                0 0 30px currentColor;
        }
        
        .module-header {
            background: linear-gradient(90deg, 
                rgba(255, 0, 51, 0.8) 0%, 
                rgba(138, 43, 226, 0.8) 100%);
            padding: 20px;
            text-align: center;
            font-weight: 700;
            font-size: 1.4em;
            letter-spacing: 1px;
            border-bottom: 3px solid;
            position: relative;
        }
        
        .module-content {
            padding: 25px;
        }
        
        /* === MODULE COLORS === */
        .phishing-module { border-color: var(--neon-cyan); }
        .phishing-module .module-header { border-color: var(--neon-cyan); }
        
        .network-module { border-color: var(--hellfire-orange); }
        .network-module .module-header { border-color: var(--hellfire-orange); }
        
        .ai-module { border-color: var(--oni-purple); }
        .ai-module .module-header { border-color: var(--oni-purple); }
        
        .wireless-module { border-color: var(--toxic-green); }
        .wireless-module .module-header { border-color: var(--toxic-green); }
        
        /* === ATTACK CONTROLS === */
        .attack-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 15px 0;
        }
        
        .control-group {
            margin-bottom: 15px;
        }
        
        .control-label {
            color: var(--demon-gold);
            font-weight: 600;
            margin-bottom: 5px;
            display: block;
        }
        
        /* === NGROK TOKEN INPUT === */
        .ngrok-token-section {
            background: linear-gradient(45deg, var(--shadow-void), var(--steel-gray));
            border: 2px solid var(--toxic-green);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .token-input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .token-input {
            flex: 1;
            background: var(--shadow-void);
            border: 1px solid var(--steel-gray);
            border-radius: 5px;
            color: white;
            padding: 10px;
            font-family: 'Courier New', monospace;
        }
        
        .token-btn {
            background: linear-gradient(45deg, var(--toxic-green), var(--neon-cyan));
            border: 1px solid var(--toxic-green);
            border-radius: 5px;
            color: black;
            padding: 10px 15px;
            cursor: pointer;
            font-weight: bold;
        }
        
        /* === PHISHING LINK DISPLAY === */
        .phishing-links-container {
            margin: 15px 0;
        }
        
        .phishing-link-card {
            background: var(--shadow-void);
            border: 2px solid var(--neon-cyan);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            animation: slideIn 0.5s ease-out;
        }
        
        .link-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .platform-badge {
            background: var(--neon-cyan);
            color: black;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 0.9em;
        }
        
        .link-url {
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            word-break: break-all;
            font-family: 'Courier New', monospace;
        }
        
        .link-url a {
            color: var(--toxic-green);
            text-decoration: none;
            font-weight: bold;
        }
        
        .link-url a:hover {
            text-decoration: underline;
        }
        
        .link-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            font-size: 0.8em;
            color: #888;
        }
        
        /* === STATUS FEEDS === */
        .status-feed {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid var(--steel-gray);
            border-radius: 8px;
            padding: 15px;
            height: 200px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.4;
            margin-top: 15px;
        }
        
        .feed-line {
            margin-bottom: 8px;
            padding-left: 12px;
            border-left: 3px solid var(--neon-cyan);
            animation: slideIn 0.3s ease-out;
        }
        
        .feed-line.success { border-left-color: var(--toxic-green); color: var(--toxic-green); }
        .feed-line.warning { border-left-color: var(--demon-gold); color: var(--demon-gold); }
        .feed-line.error { border-left-color: var(--blood-crimson); color: var(--blood-crimson); }
        .feed-line.info { border-left-color: var(--neon-cyan); color: var(--neon-cyan); }
        
        /* === LIVE PHISHING STATS === */
        .phishing-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 15px 0;
        }
        
        .stat-card {
            background: linear-gradient(145deg, var(--shadow-void), var(--steel-gray));
            border: 1px solid var(--steel-gray);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--blood-crimson), var(--oni-purple));
        }
        
        .stat-value {
            font-size: 1.8em;
            font-weight: 900;
            background: linear-gradient(45deg, var(--demon-gold), var(--neon-cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 5px 0;
        }
        
        .stat-label {
            font-size: 0.8em;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* === ANIMATIONS === */
        @keyframes float {
            0%, 100% { transform: translateY(-50%) translateX(0); }
            50% { transform: translateY(-50%) translateX(-10px); }
        }
        
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 20px currentColor; }
            50% { box-shadow: 0 0 40px currentColor, 0 0 60px var(--blood-crimson); }
        }
        
        @keyframes slideIn {
            from { 
                opacity: 0;
                transform: translateX(-20px);
            }
            to { 
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        /* === RESPONSIVE DESIGN === */
        @media (max-width: 768px) {
            .war-room {
                grid-template-columns: 1fr;
            }
            
            .targets-sidebar {
                border-right: none;
                border-bottom: 3px solid var(--demon-gold);
            }
            
            .header-title {
                font-size: 2.5em;
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- DEMON HEADER -->
    <div class="demon-header">
        <div class="header-title">ÂÜ•Âøç MYS≈åNINJA</div>
        <div class="header-subtitle">QUANTUM RED TEAM WARFARE PLATFORM</div>
        <div class="creators-badge">FORGED BY MYSTERYAK & KNIGHTDALE | OONI DEMON EDITION</div>
    </div>

    <!-- WAR ROOM -->
    <div class="war-room">
        <!-- SIDEBAR - TARGET MANAGEMENT -->
        <div class="targets-sidebar">
            <!-- NGROK TOKEN SECTION -->
            <div class="sidebar-section">
                <div class="section-title">üåê NGROK SETUP</div>
                <div class="ngrok-token-section">
                    <div class="control-label">Ngrok Auth Token</div>
                    <div class="token-input-group">
                        <input type="password" class="token-input" id="ngrok-token" placeholder="Enter your ngrok token">
                        <button class="token-btn" onclick="saveNgrokToken()">SAVE</button>
                    </div>
                    <div style="font-size: 0.8em; color: #888; margin-top: 8px;">
                        Get free token: <a href="https://dashboard.ngrok.com/get-started/your-authtoken" target="_blank" style="color: var(--neon-cyan);">ngrok.com</a>
                    </div>
                </div>
            </div>

            <!-- IP Targets -->
            <div class="sidebar-section">
                <div class="section-title">üéØ IP TARGETS</div>
                <input type="text" class="web-input" id="ip-target" placeholder="192.168.1.100">
                <input type="text" class="web-input" id="ip-description" placeholder="Description">
                <button class="web-btn" onclick="addTarget('ip')">ADD IP TARGET</button>
                <div class="target-list" id="ip-targets-list">
                    <div class="target-item">No IP targets added</div>
                </div>
            </div>

            <!-- Domain Targets -->
            <div class="sidebar-section">
                <div class="section-title">üåê DOMAIN TARGETS</div>
                <input type="text" class="web-input" id="domain-target" placeholder="target.com">
                <input type="text" class="web-input" id="domain-description" placeholder="Description">
                <button class="web-btn" onclick="addTarget('domain')">ADD DOMAIN TARGET</button>
                <div class="target-list" id="domain-targets-list">
                    <div class="target-item">No domain targets added</div>
                </div>
            </div>

            <!-- Email Targets -->
            <div class="sidebar-section">
                <div class="section-title">üìß EMAIL TARGETS</div>
                <input type="email" class="web-input" id="email-target" placeholder="target@company.com">
                <input type="text" class="web-input" id="email-description" placeholder="Description">
                <button class="web-btn" onclick="addTarget('email')">ADD EMAIL TARGET</button>
                <div class="target-list" id="email-targets-list">
                    <div class="target-item">No email targets added</div>
                </div>
            </div>
        </div>

        <!-- MAIN ATTACK AREA -->
        <div class="main-attack-area">
            <!-- DASHBOARD STATS -->
            <div class="phishing-stats">
                <div class="stat-card">
                    <div class="stat-label">Total Targets</div>
                    <div class="stat-value" id="stat-targets">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Active Campaigns</div>
                    <div class="stat-value" id="stat-campaigns">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">AI Level</div>
                    <div class="stat-value" id="stat-ai">1.0</div>
                </div>
            </div>

            <!-- ATTACK MODULES GRID -->
            <div class="attack-modules-grid">
                <!-- PHISHING MODULE -->
                <div class="attack-module phishing-module">
                    <div class="module-header">üé£ QUANTUM PHISHING GENERATOR</div>
                    <div class="module-content">
                        <div class="control-group">
                            <div class="control-label">Platform</div>
                            <select class="web-input" id="phishing-platform">
                                <option value="facebook">Facebook</option>
                                <option value="gmail">Gmail</option>
                                <option value="instagram">Instagram</option>
                                <option value="linkedin">LinkedIn</option>
                                <option value="microsoft">Microsoft</option>
                            </select>
                        </div>
                        
                        <div class="control-group">
                            <div class="control-label">Target Email (Optional)</div>
                            <input type="email" class="web-input" id="phishing-email" placeholder="victim@company.com">
                        </div>
                        
                        <div class="control-group">
                            <div class="control-label">Custom Message</div>
                            <textarea class="web-input" id="phishing-message" placeholder="Custom phishing message..." rows="3"></textarea>
                        </div>
                        
                        <div class="attack-controls">
                            <button class="web-btn" onclick="generatePhishing()">üé£ GENERATE PHISHING</button>
                            <button class="web-btn" onclick="startNgrok()">üåê START NGROK TUNNEL</button>
                        </div>
                        
                        <!-- PHISHING LINKS DISPLAY -->
                        <div class="phishing-links-container" id="phishing-links-container">
                            <!-- Phishing links will appear here -->
                        </div>
                        
                        <div class="status-feed" id="phishing-status">
                            <div class="feed-line info">> Quantum phishing engine ready</div>
                            <div class="feed-line info">> AI content generation active</div>
                        </div>
                    </div>
                </div>

                <!-- NETWORK MODULE -->
                <div class="attack-module network-module">
                    <div class="module-header">üí• NETWORK WARFARE SUITE</div>
                    <div class="module-content">
                        <div class="control-group">
                            <div class="control-label">Target</div>
                            <select class="web-input" id="scan-target">
                                <option value="">Select Target</option>
                            </select>
                        </div>
                        
                        <div class="control-group">
                            <div class="control-label">Scan Type</div>
                            <select class="web-input" id="scan-type">
                                <option value="quick">Quick Scan</option>
                                <option value="comprehensive">Comprehensive</option>
                                <option value="stealth">Stealth Scan</option>
                                <option value="vulnerability">Vulnerability Scan</option>
                            </select>
                        </div>
                        
                        <button class="web-btn" onclick="startNetworkScan()">üîç LAUNCH NETWORK SCAN</button>
                        
                        <div class="status-feed" id="network-status">
                            <div class="feed-line info">> Network warfare suite active</div>
                            <div class="feed-line info">> Nmap integration ready</div>
                        </div>
                    </div>
                </div>

                <!-- AI MODULE -->
                <div class="attack-module ai-module">
                    <div class="module-header">üîÆ QUANTUM AI ORCHESTRATOR</div>
                    <div class="module-content">
                        <div class="phishing-stats">
                            <div class="stat-card">
                                <div class="stat-label">AI Level</div>
                                <div class="stat-value" id="ai-level">1.0</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Success Prob</div>
                                <div class="stat-value" id="success-prob">85%</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-label">Blue Team</div>
                                <div class="stat-value" id="blue-strength">7/10</div>
                            </div>
                        </div>
                        
                        <div class="attack-controls">
                            <button class="web-btn" onclick="generateAIPlan()">üß† AI STRATEGY</button>
                            <button class="web-btn" onclick="evolveAI()">‚ö° EVOLVE AI</button>
                        </div>
                        
                        <div class="status-feed" id="ai-status">
                            <div class="feed-line info">> Quantum AI core initialized</div>
                            <div class="feed-line success">> Neural networks active</div>
                        </div>
                    </div>
                </div>

                <!-- WIRELESS MODULE -->
                <div class="attack-module wireless-module">
                    <div class="module-header">üì° WIRELESS WARFARE</div>
                    <div class="module-content">
                        <div class="control-group">
                            <div class="control-label">Attack Type</div>
                            <select class="web-input" id="wireless-attack">
                                <option value="wpa2">WPA2 Handshake Capture</option>
                                <option value="wps">WPS Pixie Attack</option>
                                <option value="evil_twin">Evil Twin</option>
                                <option value="deauth">Deauthentication</option>
                            </select>
                        </div>
                        
                        <div class="control-group">
                            <div class="control-label">Target BSSID</div>
                            <input type="text" class="web-input" id="target-bssid" placeholder="AA:BB:CC:DD:EE:FF">
                        </div>
                        
                        <button class="web-btn" onclick="startWirelessAttack()">üì° LAUNCH WIRELESS ATTACK</button>
                        
                        <div class="status-feed" id="wireless-status">
                            <div class="feed-line info">> Wireless warfare ready</div>
                            <div class="feed-line info">> Monitor mode capable</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let targets = { ips: [], domains: [], emails: [] };
        let ngrokToken = localStorage.getItem('ngrok_token') || '';
        let activeCampaigns = [];
        let ngrokTunnelActive = false;

        // Initialize dashboard
        async function initializeDashboard() {
            await loadTargets();
            await loadDashboardStats();
            updateTargetSelectors();
            loadNgrokToken();
            setInterval(loadDashboardStats, 3000);
        }

        // Load ngrok token from localStorage
        function loadNgrokToken() {
            const savedToken = localStorage.getItem('ngrok_token');
            if (savedToken) {
                document.getElementById('ngrok-token').value = savedToken;
                ngrokToken = savedToken;
                addStatus('phishing-status', 'Ngrok token loaded from storage', 'success');
            }
        }

        // Save ngrok token
        async function saveNgrokToken() {
            const token = document.getElementById('ngrok-token').value.trim();
            if (!token) {
                addStatus('phishing-status', 'Please enter ngrok token', 'error');
                return;
            }

            localStorage.setItem('ngrok_token', token);
            ngrokToken = token;
            
            try {
                const response = await fetch('/api/ngrok/set-token', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ token: token })
                });
                
                const result = await response.json();
                if (result.success) {
                    addStatus('phishing-status', 'Ngrok token saved and configured!', 'success');
                } else {
                    addStatus('phishing-status', result.error, 'error');
                }
            } catch (error) {
                addStatus('phishing-status', 'Token saved locally', 'warning');
            }
        }

        // Load targets from API
        async function loadTargets() {
            try {
                const response = await fetch('/api/targets/get');
                targets = await response.json();
                updateTargetLists();
            } catch (error) {
                addStatus('ai-status', `Error loading targets: ${error}`, 'error');
            }
        }

        // Update target lists in sidebar
        function updateTargetLists() {
            updateList('ip-targets-list', targets.ips, 'ip');
            updateList('domain-targets-list', targets.domains, 'domain');
            updateList('email-targets-list', targets.emails, 'email');
        }

        function updateList(elementId, items, type) {
            const list = document.getElementById(elementId);
            if (items.length === 0) {
                list.innerHTML = '<div class="target-item">No ' + type + ' targets added</div>';
            } else {
                list.innerHTML = items.slice(-5).map(item => 
                    `<div class="target-item">${item[type]} - ${item.description || 'No description'}</div>`
                ).join('');
            }
        }

        // Update target selectors
        function updateTargetSelectors() {
            const allTargets = [
                ...targets.ips.map(t => t.ip),
                ...targets.domains.map(t => t.domain)
            ];

            const scanTarget = document.getElementById('scan-target');
            scanTarget.innerHTML = '<option value="">Select Target</option>' +
                allTargets.map(t => `<option value="${t}">${t}</option>`).join('');
        }

        // Load dashboard statistics
        async function loadDashboardStats() {
            try {
                const response = await fetch('/api/dashboard/stats');
                const stats = await response.json();
                
                document.getElementById('stat-targets').textContent = stats.total_targets;
                document.getElementById('stat-campaigns').textContent = activeCampaigns.length;
                document.getElementById('stat-ai').textContent = stats.ai_intelligence.toFixed(1);
                document.getElementById('ai-level').textContent = stats.ai_intelligence.toFixed(1);
            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }

        // Add status message
        function addStatus(panelId, message, type = 'info') {
            const panel = document.getElementById(panelId);
            const line = document.createElement('div');
            line.className = `feed-line ${type}`;
            line.textContent = `> ${message}`;
            panel.appendChild(line);
            panel.scrollTop = panel.scrollHeight;
            
            // Limit to 15 messages
            if (panel.children.length > 15) {
                panel.removeChild(panel.firstChild);
            }
        }

        // Target management
        async function addTarget(type) {
            const field = type + '-target';
            const desc = type + '-description';
            const value = document.getElementById(field).value;
            const description = document.getElementById(desc).value;
            
            if (!value) {
                addStatus('ai-status', `Please enter a ${type}`, 'error');
                return;
            }

            try {
                const response = await fetch(`/api/targets/${type}/add`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({[type]: value, description})
                });
                
                const result = await response.json();
                if (result.success) {
                    addStatus('ai-status', `Added ${type} target: ${value}`, 'success');
                    document.getElementById(field).value = '';
                    document.getElementById(desc).value = '';
                    await loadTargets();
                    updateTargetSelectors();
                }
            } catch (error) {
                addStatus('ai-status', `Error adding target: ${error}`, 'error');
            }
        }

        // Phishing functions
        async function generatePhishing() {
            const platform = document.getElementById('phishing-platform').value;
            const email = document.getElementById('phishing-email').value;
            const message = document.getElementById('phishing-message').value;

            if (!ngrokToken && !ngrokTunnelActive) {
                addStatus('phishing-status', 'Please set ngrok token first!', 'error');
                return;
            }

            try {
                const response = await fetch('/api/phishing/generate', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        platform, 
                        target_email: email, 
                        custom_message: message,
                        enable_ngrok: true
                    })
                });
                
                const result = await response.json();
                
                // Add to active campaigns
                activeCampaigns.push(result);
                
                addStatus('phishing-status', `Generated ${platform} phishing campaign`, 'success');
                addStatus('phishing-status', `Campaign ID: ${result.id}`, 'info');
                
                // Display the phishing link
                displayPhishingLink(result);
                
            } catch (error) {
                addStatus('phishing-status', `Error generating phishing: ${error}`, 'error');
            }
        }

        // Display phishing link
        function displayPhishingLink(campaign) {
            const container = document.getElementById('phishing-links-container');
            
            const linkCard = document.createElement('div');
            linkCard.className = 'phishing-link-card';
            
            const platform = campaign.platform.charAt(0).toUpperCase() + campaign.platform.slice(1);
            
            linkCard.innerHTML = `
                <div class="link-header">
                    <span class="platform-badge">${platform}</span>
                    <span style="color: #888; font-size: 0.8em;">ID: ${campaign.id}</span>
                </div>
                <div class="link-url">
                    ${campaign.live_url ? 
                        `<a href="${campaign.live_url}" target="_blank">${campaign.live_url}</a>` :
                        'Generating public URL...'
                    }
                </div>
                <div class="link-stats">
                    <div>Visitors: ${campaign.visitors || 0}</div>
                    <div>Credentials: ${campaign.credentials_captured || 0}</div>
                    <div>Status: ${campaign.status}</div>
                </div>
            `;
            
            container.appendChild(linkCard);
            
            // Scroll to show new link
            linkCard.scrollIntoView({ behavior: 'smooth' });
        }

        // Ngrok functions
        async function startNgrok() {
            if (!ngrokToken) {
                addStatus('phishing-status', 'Please set ngrok token first!', 'error');
                return;
            }

            try {
                const response = await fetch('/api/ngrok/start', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'}
                });
                
                const result = await response.json();
                if (result.success) {
                    ngrokTunnelActive = true;
                    addStatus('phishing-status', 'Ngrok tunnel activated!', 'success');
                    addStatus('phishing-status', `Public URL: ${result.ngrok_url}`, 'info');
                    
                    // Update existing campaigns with new URLs
                    activeCampaigns.forEach(campaign => {
                        if (campaign.live_url) {
                            campaign.live_url = campaign.live_url.replace(/https?:\/\/[^\/]+/, result.ngrok_url);
                        }
                    });
                    
                } else {
                    addStatus('phishing-status', `Ngrok error: ${result.error}`, 'error');
                }
            } catch (error) {
                addStatus('phishing-status', `Error starting ngrok: ${error}`, 'error');
            }
        }

        // Network scanning
        async function startNetworkScan() {
            const target = document.getElementById('scan-target').value;
            const scanType = document.getElementById('scan-type').value;

            if (!target) {
                addStatus('network-status', 'Please select a target first', 'error');
                return;
            }

            try {
                const response = await fetch('/api/network/scan', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({target, type: scanType})
                });
                
                const result = await response.json();
                addStatus('network-status', `Started ${scanType} scan on ${target}`, 'warning');
                
                // Monitor scan progress
                monitorScanProgress(result.id);
                
            } catch (error) {
                addStatus('network-status', `Error starting scan: ${error}`, 'error');
            }
        }

        async function monitorScanProgress(scanId) {
            const checkProgress = setInterval(async () => {
                try {
                    const response = await fetch(`/api/network/scans/${scanId}`);
                    const scan = await response.json();
                    
                    if (scan.status === 'COMPLETED') {
                        addStatus('network-status', `Scan completed: ${scan.results}`, 'success');
                        clearInterval(checkProgress);
                    } else if (scan.status === 'FAILED') {
                        addStatus('network-status', `Scan failed: ${scan.error}`, 'error');
                        clearInterval(checkProgress);
                    }
                } catch (error) {
                    console.error('Error checking scan progress:', error);
                }
            }, 2000);
        }

        // AI functions
        async function generateAIPlan() {
            try {
                const response = await fetch('/api/ai/generate-plan', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'}
                });
                
                const result = await response.json();
                document.getElementById('success-prob').textContent = result.success_probability;
                document.getElementById('blue-strength').textContent = result.blue_team_strength + '/10';
                
                addStatus('ai-status', `AI strategy generated: ${result.success_probability} success`, 'success');
                addStatus('ai-status', `Recommended: ${result.recommended_actions[0]}`, 'info');
                
            } catch (error) {
                addStatus('ai-status', `Error generating AI plan: ${error}`, 'error');
            }
        }

        async function evolveAI() {
            try {
                const response = await fetch('/api/ai/evolve', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'}
                });
                
                const result = await response.json();
                addStatus('ai-status', result.message, 'success');
                await loadDashboardStats();
                
            } catch (error) {
                addStatus('ai-status', `Error evolving AI: ${error}`, 'error');
            }
        }

        // Wireless attacks
        async function startWirelessAttack() {
            const attackType = document.getElementById('wireless-attack').value;
            const bssid = document.getElementById('target-bssid').value;

            if (!bssid) {
                addStatus('wireless-status', 'Please enter target BSSID', 'error');
                return;
            }

            try {
                const response = await fetch('/api/wireless/attack', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        attack_type: attackType,
                        bssid: bssid
                    })
                });
                
                const result = await response.json();
                addStatus('wireless-status', `Started ${attackType} on ${bssid}`, 'warning');
                
            } catch (error) {
                addStatus('wireless-status', `Error starting wireless attack: ${error}`, 'error');
            }
        }

        // Initialize everything when page loads
        document.addEventListener('DOMContentLoaded', initializeDashboard);
    </script>
</body>
</html>
